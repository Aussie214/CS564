/* Grab name, and sum of all line items from orders within a nation */
SELECT s_nat.N_NAME, SUM(LINEITEM.L_QUANTITY * (LINEITEM.L_EXTENDEDPRICE - LINEITEM.L_DISCOUNT)) AS Order_Size
FROM LINEITEM, ORDERS, NATION AS s_nat, NATION AS c_nat, CUSTOMER, SUPPLIER
WHERE
LINEITEM.L_SUPPKEY = SUPPLIER.S_SUPPKEY
AND
SUPPLIER.S_NATIONKEY = s_nat.N_NATIONKEY
AND
LINEITEM.L_ORDERKEY = ORDERS.O_ORDERKEY 
AND
ORDERS.O_CUSTKEY = CUSTOMER.C_CUSTKEY
AND
CUSTOMER.C_NATIONKEY = c_nat.N_NATIONKEY
AND
/* Want cust and sup to be in same nation */
s_nat.N_NATIONKEY = c_nat.N_NATIONKEY
GROUP BY s_nat.N_NATIONKEY
ORDER BY s_nat.N_NAME;

/* 9074262305
